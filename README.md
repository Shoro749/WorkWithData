# Лабораторна робота №1  
**Тема:** Робота з файлами та даними у C# (CSV/JSON/XML/XLSX, звіти DOCX/XLSX, графіки)  
**Студент(ка):** Ващенко Роман Андрійович, група КН-211  
**Варіант 51 / набір даних:** coffe.csv, [джерело_  ](https://www.kaggle.com/datasets/jawad3664/coffee-shop)
**Дата:** _08.10.2025_  
**Посилання на репозиторій/архів:** [_URL або шлях_](https://github.com/Shoro749/WorkWithData)

---

## 1. Мета та завдання
**Мета:** проаналізувати продажі різних видів кави, побудувати підсумкові таблиці та графіки, щоб наочно оцінити тенденції та ключові показники продажів.
**Завдання:**  
- Імпорт даних із CSV/JSON/XML/XLSX.  
- Обробка/валідація/агрегація.  
- Експорт у всі формати (CSV/JSON/XML/XLSX).  
- Генерація звітів **XLSX** та **DOCX**.  
- Візуалізація (мінімум 2 графіки) зі стороннім компонентом.  
- Архітектура у 3 збірках (Domain/Data/UI), діаграма класів.

---

## 2. Опис датасету
**Походження/джерело:** [_URL або шлях_](https://github.com/Shoro749/WorkWithData)
**Структура полів (приклад таблиці):**

| Поле      | Тип    | Приклад значення | Опис/правила                            |
|HourOfDay  |int     |      15          |  Година, коли була зорблена транзакція  |
|CoffeeName |string  | Latte            | Назва кави / Не пустий                  |
|CashType   |string  | card             | Спосіб оплати (готівкою/картою)         |
|Money      |double  | 38,7             | Скільки було оплачено                   |
|TimeOfDay  |string  | Morning          | Коли була зроблена транзакція           |
|WeekDay    |string  | Fri              | День тижня                              |
|MonthName  |string  | Mar              | Назва місяця                            |
|WeekdaySort|int     | 2                | Номер тижня                             |
|MonthSort  |int     | 4                | Номер місяця                            |
|Date       |DateTime| 1                | Дата                                    |
|Time       |TimeSpan| 15:50.5          | Час                                     |

**Обсяг:** _рядків: 3548, стовпців: 11  
**Проблеми якості:** дублікати

---

## 3. Модель предметної області
**Виділені сутності:** CoffeeTransaction, DateInfo, Payment. 
**Зв’язки:** CoffeeTransaction асоційований один-на-один з DateInfo та Payment.
**Діаграма класів (UML):** _вставити зображення/лінк_  
<img width="849" height="1008" alt="Untitled diagram-2025-10-08-192614" src="https://github.com/user-attachments/assets/de28d8e4-9fdf-469f-b5cb-5111783f2306" />

Для аналізу продажів кави були виділені сутності: CoffeeTransaction (транзакція), Payment (платіж) та DateInfo (інформація про дату/час). Таке розділення дозволяє чітко відокремити фінансові дані від часових характеристик і типу кави, спрощує групування, агрегацію та побудову графіків, а також забезпечує гнучкість для додавання нових атрибутів без зміни структури основної транзакції.

---

## 4. Архітектура застосунку
**Збірки/шари:**  
- **Domain (Core/Model):** сутності, валідація.  
- **Data (Infrastructure):** провайдери форматів, сервіси звітів.  
- **WorkWithData (Presentation):** WPF, екрани, взаємодія з сервісами.

**Дерево рішень (спрощено):**
```
/SolutionName
  /Domain
    /models
      /CsvFileManager.cs
      /JsonFileManager.cs
      /XlsxFileManager.cs
      /XmlFileManager.cs
  /Data
    /reports
      /DocxReportGenerator.cs
      /XlsxReportGenerator.cs
  /WorkWithData
    /windows
      /CreateTransaction.xaml
      /EditTransaction.xaml
    /mainWindwo.xaml
```
**Залежності/NuGet:** CsvHelper, Newtonsoft.Json, ClosedXML, DocX, LiveCharts.

---

## 5. Імпорт та чистка даних
**Підтримувані формати імпорту:** CSV, JSON, XML, XLSX.  
**Налаштування імпорту:** 
- Кодування: UTF-8,
- Роздільник',',
- Заголовок: створюються вручну через WriteField() перед записом даних,
- Формати дат/чисел:
  - Дата — dd/MM/yyyy
  - Час — h:mm.f
**Перетворення та валідація:**  
- Правила (на рівні полів/записів): під час зчитування кожен рядок CSV перевіряється — типи полів перетворюються (int, double, DateTime, TimeSpan), неправильні або порожні значення викликають виняток.
- Обробка пропусків: якщо файл не існує або дані відсутні, повертається порожній список (if (!File.Exists(path)) return transactions;).

---

## 6. Операції над даними
**Фільтрація/пошук/сортування:** 
-Фільтрація виконується за діапазоном цін (min, max) та інтервалом дат (startDate, endDate). Перед застосуванням перевіряється правильність числового формату та логічна послідовність дат.
- Пошук реалізований за назвою кави (Coffee). Якщо поле пошуку порожнє — повертається повний список.
- Сортування підтримується стандартним DataGrid WPF (за будь-яким стовпцем при натисканні на заголовок).
**Групування та агрегування:** 
- На основі відфільтрованих даних формується статистика у вигляді графіків — використовується сума (sum) продажів за датами та категоріями.
**Редагування:** 
- Додавання: створення нового запису через діалогове вікно CreateTransaction. Після підтвердження (ShowDialog == true) нова транзакція додається до колекції transactions та оновлюється у DataGrid.
- Зміна: редагування вибраного запису через форму EditTransaction. Після збереження старий запис видаляється, а змінений додається в колекцію.
- Видалення: видалення обраного запису з DataGrid і колекції transactions.
- Перевірки цілісності: перед кожною операцією перевіряється, чи вибрано елемент, а також коректність введених даних у формах створення та редагування.

---

## 7. Експорт даних
**Підтримувані формати експорту:** CSV, JSON, XML, XLSX.  
**Параметри експорту:** 
- Кодування: UTF-8,
- Роздільник',',
- Заголовок: створюються вручну через WriteField() перед записом даних,
- Формати дат/чисел:
  - Дата — dd/MM/yyyy
  - Час — h:mm.f
**Перевірка якості експорту:** _контрольні приклади файлів, скріншоти_

---

## 8. Звіти
### 8.1 XLSX-звіт  
- Аркуш Summary: містить агреговані таблиці продажів за кавою, датами та годинам; використане умовне форматування для підсвічування високих/низьких значень.
- Таблиці з ключовими метриками (суми, середні значення, кількість продажів).
<img width="1261" height="994" alt="image" src="https://github.com/user-attachments/assets/172654c2-5457-4982-a3f5-bfcba0133cb4" />


### 8.2 DOCX-звіт  
- Титульна сторінка з ПІБ, групою, варіантом роботи та описом використовуваного датасету.
- Аркуш Charts: містить 1–2 діаграми (лінійна та стовпчикова) з підписами осей і назвами серій.
<img width="656" height="594" alt="image" src="https://github.com/user-attachments/assets/8cd28c61-4bc0-45fc-9219-e1dd9ed0013f" />


---

## 9. Візуалізація
**Компонент:** LiveCharts.WPF_  
**Побудовані графіки (мін. 2):**  
- Типи:
  - LineSeries — лінійна діаграма.
      - X: година доби (HourOfDay)
      - Y: сума (Payment.Money)
  - ColumnSeries — стовпчикова діаграма.
      - X: назва кави (Coffee)
      - Y: кількість продажів (Count) 
<img width="778" height="365" alt="image" src="https://github.com/user-attachments/assets/de44e99e-ea6d-4651-96d2-2c362fe8337d" />


---

## 10. Інтерфейс користувача
**Екрани/форми:** _головна форма, імпорт, експорт, фільтри, графіки_  
- Головна форма — відображає основну інформацію про транзакції (таблиця з даними, кнопки імпорту, фільтрів).
- Імпорт/експорт даних:
  - Open — відкриває діалог для вибору файлу, після чого додає дані у колекцію transactions.
  - Save as — відкриває діалог для вибору формату експорту (CSV, XLSX, JSON, XML) та папки для збереження, а потім виконує запис даних.
- Фільтри — панель збоку на головній сторінці, що дозволяє вибрати параметри відображення (період, ціна).
- Графіки — вкладка з кількома типами діаграм (лінійний, стовпчиковий), що відображають аналітику продажів за типом кави, датою або кількістю.
**Повідомлення про помилки/винятки:** 
<img width="715" height="376" alt="image" src="https://github.com/user-attachments/assets/ccb2d1a9-a61a-4485-8a3f-034cf5e092ce" />


---

## 11. Перевірка продуктивності та надійності
- Обсяг даних, на якому тестувалося (3548 рядків).  
- Час імпорту/експорту/побудови графіків (10 сек).  
- Тестові кейси з некоректними файлами:
<img width="451" height="201" alt="image" src="https://github.com/user-attachments/assets/7af36ad8-e5df-48f9-9902-870d6499f30d" />


---

## 12. Контрольні питання (для самоперевірки)
1. Чому обрана саме така модель сутностей і зв’язків?
   - Класи CoffeeTransaction, Payment та DateInfo відображають реальні атрибути продажів кави; зв’язки 1-до-1 забезпечують чітке розділення даних та простоту доступу до інформації.  
2. Де реалізовані валідація й агрегування?  
  - Валідація здійснюється у методах імпорту (Load) та у формі фільтрації/редагування (ApplyFilter_Click, Create_Click, Edit_Click).
  - Агрегування даних відбувається при генерації графіків (GenerateLineChart, GenerateColumnChart) і підрахунку сум, кількостей та середніх значень.
3. Як реалізовано імпорт кожного формату?  
  - За допомогою спеціальних пакетів з налаштуванням роздільника, кодування та форматів дат/часу.
4. Як обробляються типові помилки I/O?  
  - Перевірка на існування файлу (File.Exists), виключення при помилках читання/запису, некоректних числових та датових значеннях.
  - Всі винятки ловляться та виводяться через MessageBox або передаються далі з описом помилки за допомогою try-catch.
5. Як формується кожен графік і як оновлюється при фільтрах?
  - Лінійні та стовпчикові графіки формуються на основі відфільтрованих колекцій transactions.
  - Після застосування фільтрів (ApplyFilter_Click) або пошуку (Search_Click) таблиця та графіки оновлюються викликом UpdateTransactions і методів GenerateLineChart / GenerateColumnChart.

---

## 13. Використання AI
- Які інструменти AI застосовано: ChatGPT
- Для чого саме: довідка, приклади коду, допомога у рефакторингу. 
- **Підтвердження:** _“Усі фрагменти коду у фінальній версії я повністю розумію та можу пояснити на захисті.”_

---

## 14. Висновки
Розроблено систему для обробки, аналізу та візуалізації транзакцій продажу кави з можливістю імпорту та експорту даних у різних форматах.
Удалося реалізувати фільтрацію, пошук, сортування, редагування записів та генерацію лінійних і стовпчикових графіків.
Можна покращити обробку дублікатів та пропусків, додати нові типи графіків.
