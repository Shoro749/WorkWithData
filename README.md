# Лабораторна робота №1  
**Тема:** Робота з файлами та даними у C# (CSV/JSON/XML/XLSX, звіти DOCX/XLSX, графіки)  
**Студент(ка):** Ващенко Роман Андрійович, група КН-211  
**Варіант 51 / набір даних:** coffe.csv, [джерело_  ](https://www.kaggle.com/datasets/jawad3664/coffee-shop)
**Дата:** _ДД.ММ.РРРР_  
**Посилання на репозиторій/архів:** [_URL або шлях_](https://github.com/Shoro749/WorkWithData)

---

## 1. Мета та завдання
**Мета:** проаналізувати продажі різних видів кави, побудувати підсумкові таблиці та графіки, щоб наочно оцінити тенденції та ключові показники продажів.
**Завдання:**  
- Імпорт даних із CSV/JSON/XML/XLSX.  
- Обробка/валідація/агрегація.  
- Експорт у всі формати (CSV/JSON/XML/XLSX).  
- Генерація звітів **XLSX** та **DOCX**.  
- Візуалізація (мінімум 2 графіки) зі стороннім компонентом.  
- Архітектура у 3 збірках (Domain/Data/UI), діаграма класів.

---

## 2. Опис датасету
**Походження/джерело:** [_URL або шлях_](https://github.com/Shoro749/WorkWithData)
**Структура полів (приклад таблиці):**

| Поле      | Тип    | Приклад значення | Опис/правила                            |
|HourOfDay  |int     |      15          |  Година, коли була зорблена транзакція  |
|CoffeeName |string  | Latte            | Назва кави / Не пустий                  |
|CashType   |string  | card             | Спосіб оплати (готівкою/картою)         |
|Money      |double  | 38,7             | Скільки було оплачено                   |
|TimeOfDay  |string  | Morning          | Коли була зроблена транзакція           |
|WeekDay    |string  | Fri              | День тижня                              |
|MonthName  |string  | Mar              | Назва місяця                            |
|WeekdaySort|int     | 2                | Номер тижня                             |
|MonthSort  |int     | 4                | Номер місяця                            |
|Date       |DateTime| 1                | Дата                                    |
|Time       |TimeSpan| 15:50.5          | Час                                     |

**Обсяг:** _рядків: 3548, стовпців: 11  
**Проблеми якості:** дублікати

---

## 3. Модель предметної області
**Виділені сутності:** CoffeeTransaction, DateInfo, Payment. 
**Зв’язки:** CoffeeTransaction асоційований один-на-один з DateInfo та Payment.
**Діаграма класів (UML):** _вставити зображення/лінк_  
<img width="849" height="1008" alt="Untitled diagram-2025-10-08-192614" src="https://github.com/user-attachments/assets/de28d8e4-9fdf-469f-b5cb-5111783f2306" />

Для аналізу продажів кави були виділені сутності: CoffeeTransaction (транзакція), Payment (платіж) та DateInfo (інформація про дату/час). Таке розділення дозволяє чітко відокремити фінансові дані від часових характеристик і типу кави, спрощує групування, агрегацію та побудову графіків, а також забезпечує гнучкість для додавання нових атрибутів без зміни структури основної транзакції.
---

## 4. Архітектура застосунку
**Збірки/шари:**  
- **Domain (Core/Model):** сутності, валідація.  
- **Data (Infrastructure):** провайдери форматів, сервіси звітів.  
- **WorkWithData (Presentation):** WPF, екрани, взаємодія з сервісами.

**Дерево рішень (спрощено):**
```
/SolutionName
  /Domain
    /models
      /CsvFileManager.cs
      /JsonFileManager.cs
      /XlsxFileManager.cs
      /XmlFileManager.cs
  /Data
    /reports
      /DocxReportGenerator.cs
      /XlsxReportGenerator.cs
  /WorkWithData
    /windows
      /CreateTransaction.xaml
      /EditTransaction.xaml
    /mainWindwo.xaml
```
**Залежності/NuGet:** _CsvHelper, Newtonsoft.Json, ClosedXML, DocX, LiveCharts ._

---

## 5. Імпорт та чистка даних
**Підтримувані формати імпорту:** CSV, JSON, XML, XLSX.  
**Налаштування імпорту:** 
- Кодування: UTF-8,
- Роздільник',',
- Заголовок: створюються вручну через WriteField() перед записом даних,
- Формати дат/чисел:
  - Дата — dd/MM/yyyy
  - Час — h:mm.f
**Перетворення та валідація:**  
- Правила (на рівні полів/записів): під час зчитування кожен рядок CSV перевіряється — типи полів перетворюються (int, double, DateTime, TimeSpan), неправильні або порожні значення викликають виняток.
- Обробка пропусків: якщо файл не існує або дані відсутні, повертається порожній список (if (!File.Exists(path)) return transactions;).

---

## 6. Операції над даними
**Фільтрація/пошук/сортування:** 
-Фільтрація виконується за діапазоном цін (min, max) та інтервалом дат (startDate, endDate). Перед застосуванням перевіряється правильність числового формату та логічна послідовність дат.
- Пошук реалізований за назвою кави (Coffee). Якщо поле пошуку порожнє — повертається повний список.
- Сортування підтримується стандартним DataGrid WPF (за будь-яким стовпцем при натисканні на заголовок).
**Групування та агрегування:** 
- На основі відфільтрованих даних формується статистика у вигляді графіків — використовується сума (sum) продажів за датами та категоріями.
**Редагування:** 
- Додавання: створення нового запису через діалогове вікно CreateTransaction. Після підтвердження (ShowDialog == true) нова транзакція додається до колекції transactions та оновлюється у DataGrid.
- Зміна: редагування вибраного запису через форму EditTransaction. Після збереження старий запис видаляється, а змінений додається в колекцію.
- Видалення: видалення обраного запису з DataGrid і колекції transactions.
- Перевірки цілісності: перед кожною операцією перевіряється, чи вибрано елемент, а також коректність введених даних у формах створення та редагування.

---

## 7. Експорт даних
**Підтримувані формати експорту:** CSV, JSON, XML, XLSX.  
**Параметри експорту:** 
- Кодування: UTF-8,
- Роздільник',',
- Заголовок: створюються вручну через WriteField() перед записом даних,
- Формати дат/чисел:
  - Дата — dd/MM/yyyy
  - Час — h:mm.f
**Перевірка якості експорту:** _контрольні приклади файлів, скріншоти_

---

## 8. Звіти
### 8.1 XLSX-звіт  
- Аркуш **Summary**: агреговані таблиці, умовне форматування.  
- Аркуш **Charts**: 1–2 діаграми з підписами.  
- Скріншоти/прикріплені файли.

### 8.2 DOCX-звіт  
- Титульна сторінка (ПІБ, група, варіант, опис датасету).  
- Таблиці з ключовими метриками.  
- Вставлені зображення графіків (PNG).  
- Короткі висновки (2–3 абзаци).  
- Скріншоти/прикріплені файли.

---

## 9. Візуалізація
**Компонент:** LiveCharts.WPF_  
**Побудовані графіки (мін. 2):**  
- Типи:
  - LineSeries — лінійна діаграма.
      - X: година доби (HourOfDay)
      - Y: сума (Payment.Money)
  - ColumnSeries — стовпчикова діаграма.
      - X: назва кави (Coffee)
      - Y: кількість продажів (Count) 
<img width="778" height="365" alt="image" src="https://github.com/user-attachments/assets/de44e99e-ea6d-4651-96d2-2c362fe8337d" />


---

## 10. Інтерфейс користувача
**Екрани/форми:** _головна форма, імпорт, експорт, фільтри, графіки_  
**Сценарії використання:** _кроки: відкрити → огляд → обробка → звіти → експорт_  
**Повідомлення про помилки/винятки:** _приклади та скріни_  
**Логи:** _де зберігаються, формат рядка логу_

---

## 11. Перевірка продуктивності та надійності
- Обсяг даних, на якому тестувалося (N рядків).  
- Час імпорту/експорту/побудови графіків.  
- Обробка великого файлу (поведінка UI, прогрес-бар).  
- Тестові кейси з некоректними файлами (кодування, заблокований файл тощо).

---

## 12. Контрольні питання (для самоперевірки)
1. Чому обрана саме така модель сутностей і зв’язків?  
2. Де реалізовані валідація й агрегування?  
3. Як реалізовано імпорт кожного формату?  
4. Як обробляються типові помилки I/O?  
5. Як формується кожен звіт і як оновлюється при фільтрах?

---

## 13. Використання AI
- Які інструменти AI застосовано: _ChatGPT/Copilot/…_  
- Для чого саме: _довідка/приклади/рефакторинг_  
- Що змінено/дороблено власноруч: _конкретні приклади_  
- **Підтвердження:** _“Усі фрагменти коду у фінальній версії я повністю розумію та можу пояснити на захисті.”_

---

## 14. Висновки
- Короткий підсумок виконаного (2–4 речення).  
- Що вдалось/що покращити.  
- Ідеї для розвитку (нові звіти/візуалізації/функції).

---

## 15. Додатки
- **A. Фрагменти коду** (ключові методи з короткими коментарями).  
- **B. Повні файли звітів** (XLSX, DOCX) — шляхи/посилання.  
- **C. Експортовані приклади** (CSV/JSON/XML/XLSX).  
- **D. Діаграма класів (UML)** — PNG/PDF.  
- **E. Скріни UI** (головні сценарії).  
